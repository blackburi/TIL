{% extends "base.html" %}


{% block content %}
  <br>
  <h1>ì˜í™” ì •ë³´</h1>
  <hr>
  <p>ì˜í™” ì œëª© : {{ movie.title }}</p>
  <hr>
  {% if movie.image %}
    <img src="{{ movie.image.url }}" alt="movie image">
  {% else %}
    ì¤€ë¹„ëœ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì¤€ë¹„í•˜ê² ìŠµë‹ˆë‹¤.
  {% endif %}
  <hr>
  <p> ë‚´ìš© : {{ movie.content }}</p>
  <hr>
  {% if request.user == movie.user %}
    <a href="{% url "movies:update" movie.pk %}" method="POST">
      <input type="submit" value="ìˆ˜ì •">
    </a>
    <a href="{% url "movies:delete" movie.pk %}" method="POST">
      <input type="submit" value="ì‚­ì œ">
    </a>
  {% endif %}
  <hr>
  <h2>ëŒ“ê¸€ ëª©ë¡</h2>
  <br>
  {% if comments %}
    <ul>
      {% for comment in comments %}
        <li>{{ comment.content }}</li>
        {% if request.user == comment.user %}
          {{ comment.like_users.all|length }}
          <form action="{% url "movies:delete_comment" movie.pk comment.pk %}" method="POST">
            {% csrf_token %}
            <input type="submit" value="ì‚­ì œ">
          </form>
        {% else %}
          <div class='d-flex w-10'>
            {{ comment.like_users.all|length }}
            <form action="{% url "movies:likes_comment" movie.pk comment.pk %}" method="POST">
              {% csrf_token %}
              {% if request.user in comment.like_users.all %}
                <input type="submit" value="â¤">
              {% else %}
                <input type="submit" value="ğŸ¤">
              {% endif %}
            </form>
          </div>
        {% endif %}
        <br>
      {% endfor %}
    </ul>
  {% else %}
    <li>ì‘ì„±ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>
  {% endif %}
  <hr>
  {% if request.user.is_authenticated %}
    {% if request.user == movie.user %}
    {% else %}
      <form action="{% url "movies:create_comment" movie.pk %}" method="POST">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <input type="submit" value="ëŒ“ê¸€ ì‘ì„±">
      </form>
    {% endif %}
  {% endif %}
  <br>
  <br>
{% endblock content %}
